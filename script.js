const translations = {
    ko: {
        "nav.home": "홈",
        "nav.about": "동아리 소개",
        "nav.gallery": "작품 갤러리",
        "nav.pursuit": "추구하는 바",
        "nav.workflow": "워크플로우",
        "nav.join": "부원 모집",
        "nav.contact": "문의하기",
        "nav.portfolio": "포트폴리오",
        "nav.title": "진부중학교 3D 동아리",
        "hero.title": "상상을 현실로,<br>창작의 세계",
        "hero.subtitle": "진부중학교 3D 동아리입니다.",
        "hero.cta": "작품 보러가기",
        "hero.join": "지금 지원하기",
        "about.title": "About",
        "about.subtitle": "창의력과 기술의 만남",
        "about.desc": "3D 창작물을 통해 우리가 오랫동안 기억하고 싶은것, 이제는 볼수없는것, 현실에 없는것을 만들어냅니다. 그리고 그 배경에는 무료 오픈소스 프로그램 'Blender'가 있습니다.",
        "gallery.title": "Gallery",
        "gallery.subtitle": "부원들의 열정이 담긴 작품들입니다.",
        "gallery.more": "더 많은 작품 보기",
        "footer.club": "진부중학교 3D 동아리",
        "footer.address": "강원특별자치도 평창군 진부면",
        "gallery.page.title": "전체 작품 갤러리",
        "gallery.page.subtitle": "동아리 부원들의 창의적인 작품들을 모두 만나보세요.",
        "gallery.work.2025": "2025년도 작품",
        "pursuit.more": "동아리의 방향",
        "pursuit.title": "Pursuit",
        "pursuit.subtitle": "추구하는 바는 다음과 같습니다.",
        "pursuit.page.title": "추구하는 바",
        "pursuit.page.subtitle": "동아리의 정체성을 정리하였습니다.",
        "pursuit.value1.title": "자유로운 창작",
        "pursuit.value1.desc": "우리는 자유를 지향합니다.<br>당신의 엉뚱하고 기발한 아이디어,<br>그 모든 것이 예술이 되는 공간입니다.",
        "pursuit.value2.title": "자신만의 스타일",
        "pursuit.value2.desc": "유행을 따르기보다 나만의 스타일을 찾습니다. 부원 각자가 가진 고유한 개성과 감성이<br>작품에 자연스럽게 스며들도록 합니다.",
        "pursuit.value3.title": "끊임없는 도전",
        "pursuit.value3.desc": "실패는 또 다른 배움의 기회입니다.<br>Blender의 수많은 기능을 탐구하고<br>새로운 기법을 시도하며 매일 성장합니다.",
        "pursuit.vision.title": "VISION",
        "pursuit.vision.desc": "<strong>'상상은 현실이 된다'</strong><br><br>진부중학교 3D 동아리는 단순한 툴 학습을 넘어,<br>창작을 위한 새로운 언어를 배웁니다.<br>우리는 서로 영감을 주고받으며 함께 성장합니다.",
        "pursuit.style.title": "우리의 스타일",
        "pursuit.style.desc": "미래를 향한 첫 걸음, 트렌드를 넘어서는 데서 시작됩니다.",
        "pursuit.style.desc2": "미니멀니즘, 과도한 디테일은 필요하지 않습니다.",
        "workflow.subtitle": "작품이 만들어지는 6단계 과정입니다.",
        "workflow.step1.title": "아이디어",
        "workflow.step1.desc": "무엇을 만들지 상상하고 구체화합니다.",
        "workflow.step2.title": "기획",
        "workflow.step2.desc": "레퍼런스를 수집하고 전체적인 설계를 합니다.",
        "workflow.step3.title": "모델링",
        "workflow.step3.desc": "3D 공간에 물체의 형태를 만듭니다.",
        "workflow.step4.title": "리깅/애니메이팅",
        "workflow.step4.desc": "뼈대를 심고 움직임을 부여합니다.",
        "workflow.step5.title": "텍스쳐링",
        "workflow.step5.desc": "재질과 색상을 입혀 리얼리티를 더합니다.",
        "workflow.step6.title": "렌더",
        "workflow.step6.desc": "조명과 카메라를 설정하여 최종 이미지를 출력합니다.",
        "workflow.start_experience": "직접 경험해보기",
        "workflow.start_experience_sub": "웹 브라우저에서 바로 작동하는 3D 가상 스튜디오를 체험해보세요.",
        "contact.title": "문의하기",
        "contact.subtitle": "무엇이든 물어보세요! 신속하게 답변해 드리겠습니다.",
        "contact.name": "이름",
        "contact.info": "연락처 (이메일/번호)",
        "contact.message": "문의 내용",
        "contact.submit": "문의 보내기",
        "contact.file": "파일 첨부 (선택 사항)",
        "contact.success": "문의가 성공적으로 전송되었습니다!"
    },
    en: {
        "nav.home": "Home",
        "nav.about": "About",
        "nav.gallery": "Gallery",
        "nav.pursuit": "Pursuit",
        "nav.workflow": "Workflow",
        "nav.join": "Join Us",
        "nav.contact": "Contact",
        "nav.portfolio": "Portfolio",
        "nav.title": "Jinbu Middle School 3D Club",
        "hero.title": "Imagination to Reality,<br>World of Creation",
        "hero.subtitle": "Jinbu Middle School 3D Club",
        "hero.cta": "View Works",
        "hero.join": "Apply Now",
        "about.title": "About",
        "about.subtitle": "Where Creativity Meets Technology",
        "about.desc": "We turn ideas into reality through 3D modeling. and we learn various tools like 'Blender' and grow together.",
        "gallery.title": "Gallery",
        "gallery.subtitle": "Works filled with our members' passion.",
        "gallery.more": "View More Works",
        "footer.club": "Jinbu Middle School 3D Club",
        "footer.address": "Jinbu-myeon, Pyeongchang-gun, Gangwon-do",
        "gallery.page.title": "Full Gallery",
        "gallery.page.subtitle": "Explore all creative works by our members.",
        "gallery.work.2025": "2025 Work",
        "workflow.subtitle": "The 6-step creation process.",
        "workflow.step1.title": "Idea",
        "workflow.step1.desc": "Imagine and conceptualize what to create.",
        "workflow.step2.title": "Planning",
        "workflow.step2.desc": "Collect references and plan the overall design.",
        "workflow.step3.title": "Modeling",
        "workflow.step3.desc": "Create the shape of the object in 3D space.",
        "workflow.step4.title": "Rigging/Animating",
        "workflow.step4.desc": "Add bones and movement to the model.",
        "workflow.step5.title": "Texturing",
        "workflow.step5.desc": "Apply materials and colors for realism.",
        "workflow.step6.title": "Render",
        "workflow.step6.desc": "Set lighting and camera to output the final image.",
        "workflow.start_experience": "Experience it yourself",
        "workflow.start_experience_sub": "Try the 3D Virtual Studio that works right in your browser.",
        "contact.title": "Contact Us",
        "contact.subtitle": "Ask us anything! We'll get back to you soon.",
        "contact.name": "Name",
        "contact.info": "Contact Info (Email/Phone)",
        "contact.message": "Message",
        "contact.submit": "Send Message",
        "contact.file": "Attach File (Optional)",
        "contact.success": "Your inquiry has been sent successfully!",
        "pursuit.more": "More about our club",
        "pursuit.title": "Pursuit",
        "pursuit.subtitle": "The Pursuit of the club is as follows.",
        "pursuit.page.title": "Our Pursuit",
        "pursuit.page.subtitle": "Defining the identity of our club.",
        "pursuit.value1.title": "Free Creation",
        "pursuit.value1.desc": "We aim for freedom without boundaries.<br>Your wacky and brilliant ideas,<br>turn into art in this space.",
        "pursuit.value2.title": "Unique Style",
        "pursuit.value2.desc": "We find our own voice rather than following trends.<br>We encourage each member's unique personality<br>to naturally permeate their work.",
        "pursuit.value3.title": "Non-stop Challenge",
        "pursuit.value3.desc": "Failure is another opportunity to learn.<br>We explore Blender's countless features<br>and grow every day by trying new techniques.",
        "pursuit.vision.title": "Our Vision",
        "pursuit.vision.desc": "<strong>'Imagination Becomes Reality'</strong><br><br>Beyond simple technical skills,<br>we learn a new language to express ourselves in the digital world.<br>We inspire each other and grow together as 3D artists.",
        "pursuit.style.title": "Our Style",
        "pursuit.style.desc": "We embrace minimalism, where unnecessary details are not needed.",
        "pursuit.style.desc2": "We embrace minimalism, where unnecessary details are not needed."
    }
};

let currentLang = 'ko';

function updateLanguage(lang) {
    currentLang = lang;
    document.documentElement.lang = lang;

    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            el.innerHTML = translations[lang][key];
        }
    });

    const dropbtns = document.querySelectorAll('.lang-dropbtn');
    dropbtns.forEach(btn => {
        btn.innerHTML = lang === 'ko' ? '한국어 ▾' : 'English ▾';
    });
}

document.addEventListener('DOMContentLoaded', () => {
    // --- Navbar Scroll Effect ---
    const navbar = document.querySelector('.navbar');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 20) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    });

    // --- Intersection Observer for Fade-in Animations ---
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    const animatedElements = document.querySelectorAll('.section-title, .section-subtitle, .about-text, .about-image, .workflow-text, .workflow-image, .gallery-item, .glass-card, .vision-section, .hero-title, .brand-identity-section');
    animatedElements.forEach(el => {
        el.classList.add('fade-in');
        observer.observe(el);
    });

    // --- Smooth Scrolling ---
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // --- Language Selection ---
    const langLinks = document.querySelectorAll('[data-lang]');
    langLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const lang = e.target.getAttribute('data-lang');
            updateLanguage(lang);
        });
    });
    updateLanguage('ko');

    // --- Logo Comparison Slider ---
    function initComparisons() {
        const container = document.querySelector('.img-comp-container');
        const overlay = document.querySelector('.img-comp-overlay');
        const handle = document.querySelector('.comp-slider-handle');
        if (!container || !overlay || !handle) return;

        let clicked = 0;
        let w = container.offsetWidth;
        slide(w / 2);

        handle.addEventListener("mousedown", slideReady);
        handle.addEventListener("touchstart", slideReady);
        container.addEventListener("mousedown", slideReady);
        container.addEventListener("touchstart", slideReady);
        window.addEventListener("mouseup", slideFinish);
        window.addEventListener("touchend", slideFinish);

        function slideReady(e) {
            e.preventDefault();
            clicked = 1;
            container.classList.add('dragging');
            window.addEventListener("mousemove", slideMove);
            window.addEventListener("touchmove", slideMove);
            slideMove(e);
        }

        function slideFinish() {
            clicked = 0;
            container.classList.remove('dragging');
            window.removeEventListener("mousemove", slideMove);
            window.removeEventListener("touchmove", slideMove);
        }

        function slideMove(e) {
            if (clicked == 0) return;
            let pos = getCursorPos(e);
            if (pos < 0) pos = 0;
            if (pos > w) pos = w;
            slide(pos);
        }

        function getCursorPos(e) {
            e = (e.changedTouches) ? e.changedTouches[0] : e;
            const a = container.getBoundingClientRect();
            return e.clientX - a.left;
        }

        function slide(x) {
            overlay.style.width = x + "px";
            handle.style.left = overlay.offsetWidth + "px";
        }
    }
    initComparisons();

    // --- Color Palette Copy ---
    const colorSwatches = document.querySelectorAll('.color-swatch-item');
    colorSwatches.forEach(swatch => {
        swatch.addEventListener('click', () => {
            const colorCode = swatch.getAttribute('data-color');
            const codeElement = swatch.querySelector('.color-code');
            const originalText = codeElement.innerText;

            const showSuccess = () => {
                codeElement.innerText = "Copied!";
                codeElement.style.color = "#4ade80";
                setTimeout(() => {
                    codeElement.innerText = originalText;
                    codeElement.style.color = "";
                }, 1500);
            };

            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(colorCode).then(showSuccess);
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = colorCode;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showSuccess();
            }
        });
    });

    // --- Neon Pipeline Progress & Node Activation ---
    const workflowSection = document.querySelector('.workflow-section');
    const pipelineFill = document.querySelector('.pipeline-fill');
    const workflowNodes = document.querySelectorAll('.workflow-node-item');

    function updateTimeline() {
        if (!workflowSection || !pipelineFill) return;

        const windowHeight = window.innerHeight;
        const system = document.querySelector('.workflow-system');
        if (!system) return;

        const systemRect = system.getBoundingClientRect();
        const isMobile = window.innerWidth <= 768;

        // 1. Pipeline Progress
        // Mobile needs slightly different trigger points to feel right
        const drawPoint = windowHeight * (isMobile ? 0.5 : 0.6);
        let progress = (drawPoint - systemRect.top) / systemRect.height;
        progress = Math.max(0, Math.min(1, progress));
        pipelineFill.style.height = `${progress * 100}%`;

        // 2. Atmosphere Shift
        if (progress > 0.05 && progress < 0.95) {
            document.body.classList.add('workflow-active');
        } else {
            document.body.classList.remove('workflow-active');
        }

        // 3. Precise Node Activation
        // On mobile, trigger closer to the center of the screen
        const activationZone = windowHeight * (isMobile ? 0.55 : 0.65);
        workflowNodes.forEach(node => {
            const nodePoint = node.querySelector('.node-point');
            if (!nodePoint) return;
            const pointRect = nodePoint.getBoundingClientRect();
            const pointCenter = pointRect.top + (pointRect.height / 2);

            if (pointCenter < activationZone) {
                node.classList.add('active');
            } else {
                node.classList.remove('active');
            }
        });
    }

    window.addEventListener('scroll', () => {
        requestAnimationFrame(updateTimeline);
    });
    updateTimeline();

    // --- 3D Magnet Interaction ---
    const workflowCards = document.querySelectorAll('.workflow-card');
    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

    if (!isTouchDevice) {
        workflowCards.forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const rotateX = ((y - centerY) / centerY) * -10;
                const rotateY = ((x - centerX) / centerX) * 10;
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.03, 1.03, 1.03)`;
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = '';
            });
        });
    }

    // --- Mouse Parallax ---
    const heroTitle = document.querySelector('.hero-title');
    const heroSubtitle = document.querySelector('.hero-subtitle');
    const globalBg = document.querySelector('.global-background');

    document.addEventListener('mousemove', (e) => {
        const xPos = (e.clientX / window.innerWidth - 0.5) * 2;
        const yPos = (e.clientY / window.innerHeight - 0.5) * 2;
        if (heroTitle) heroTitle.style.transform = `translate(${xPos * -20}px, ${yPos * -20}px)`;
        if (heroSubtitle) heroSubtitle.style.transform = `translate(${xPos * -10}px, ${yPos * -10}px)`;
        if (globalBg) globalBg.style.transform = `translate(${xPos * 10}px, ${yPos * 10}px) scale(1.1)`;
    });

    window.addEventListener('scroll', () => {
        const scrolled = window.scrollY;
        const aboutImage = document.querySelector('.about-image img');
        if (aboutImage) {
            aboutImage.style.transform = `translateY(${scrolled * 0.1}px)`;
        }
    });

    // --- Contact Form Submission ---
    const contactForm = document.getElementById('contact-form');
    const contactSubmitBtn = document.getElementById('contact-submit-btn');
    const contactSuccessMsg = document.getElementById('contact-success');

    // [중요] join-script.js와 동일한 구글 앱스 스크립트 URL을 입력하세요.
    const CONTACT_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzBHxUU4Nx9JcTEagrClAwc8qHVMA0Lmwa6X3Abfr-OEqu4f4gogNkpLntc6nDWvJGI/exec';

    if (contactForm) {
        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const originalBtnContent = contactSubmitBtn.innerHTML;
            contactSubmitBtn.disabled = true;
            contactSubmitBtn.innerHTML = '<span>Sending...</span> <div class="loading-spinner"></div>';

            const formData = new FormData(contactForm);
            const data = Object.fromEntries(formData.entries());
            data.type = 'contact';

            console.log("=== 파일 업로드 기능 제거됨 ===");
            console.log("1. 폼 데이터:", data);

            // File Upload Logic Removed as per user request
            console.log("2. 파일 첨부 기능이 비활성화되었습니다.");

            console.log("10. 최종 전송 데이터:", data);
            console.log("11. 데이터 크기 (JSON):", JSON.stringify(data).length, "bytes");

            try {
                if (!CONTACT_SCRIPT_URL) {
                    throw new Error("Target URL is not defined.");
                }

                console.log("12. 서버로 전송 시작...");
                console.log("13. URL:", CONTACT_SCRIPT_URL);

                const response = await fetch(CONTACT_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // [중요] CORS 에러 우회를 위해 no-cors 사용
                    body: JSON.stringify(data),
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' }
                });

                console.log("14. 서버로 데이터 전송 완료 (no-cors 모드)");

                // no-cors 모드에서는 응답 내용을 확인할 수 없으므로(opaque response),
                // 네트워크 오류가 발생하지 않는 한 성공으로 간주하고 처리합니다.

                // Reset button state
                contactSubmitBtn.disabled = false;
                contactSubmitBtn.innerHTML = originalBtnContent;

                console.log("15. 성공 메시지 표시");
                contactForm.classList.add('hidden');
                contactSuccessMsg.classList.remove('hidden');
            } catch (error) {
                console.error("16. 전송 실패:", error);
                alert("전송에 실패했습니다. 연결 상태를 확인하거나 잠시 후 다시 시도해 주세요.\\n(오류 내용: " + error.message + ")");

                // 버튼 복구
                contactSubmitBtn.disabled = false;
                contactSubmitBtn.innerHTML = originalBtnContent;
            }
        });
    }

    // --- Gallery Exhibition Logic ---
    // [New] Dynamic Rendering from gallery-data.js
    const galleryContainer = document.getElementById('gallery-container');
    if (galleryContainer && typeof galleryData !== 'undefined') {
        galleryContainer.innerHTML = ''; // Clear existing content

        galleryData.forEach(item => {
            const card = document.createElement('div');
            card.classList.add('gallery-card');
            card.setAttribute('data-creator', item.creator);
            card.setAttribute('data-year', item.year);
            card.setAttribute('data-id', item.id); // Useful for modal lookup

            card.innerHTML = `
                <div class="card-inner">
                    <img src="${item.image}" alt="${item.title}">
                    <div class="card-info">
                        <span class="creator-badge">${item.creatorName}</span>
                        <h3>${item.title}</h3>
                        <button class="view-detail-btn">View Detail</button>
                    </div>
                </div>
            `;
            galleryContainer.appendChild(card);
        });
    }

    const filterItems = document.querySelectorAll('.filter-item');
    const galleryCards = document.querySelectorAll('.gallery-card');

    // 1. Filtering System
    if (filterItems.length > 0) {
        filterItems.forEach(item => {
            item.addEventListener('click', () => {
                // Update active state
                filterItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');

                const filterValue = item.getAttribute('data-filter');

                galleryCards.forEach(card => {
                    const cardCreator = card.getAttribute('data-creator');

                    // Simple animation for filtering
                    card.style.opacity = '0';
                    card.style.transform = 'scale(0.9)';

                    setTimeout(() => {
                        if (filterValue === 'all' || filterValue === cardCreator) {
                            card.style.display = 'block';
                            setTimeout(() => {
                                card.style.opacity = '1';
                                card.style.transform = 'scale(1)';
                            }, 50);
                        } else {
                            card.style.display = 'none';
                        }
                    }, 300);
                });
            });
        });
    }

    // 2. Modal System
    const modal = document.getElementById('project-modal');
    if (modal) {
        const modalImg = document.getElementById('modal-img');
        const modalTitle = document.getElementById('modal-title');
        const modalCreator = document.getElementById('modal-creator');
        const modalYear = document.getElementById('modal-year');
        const modalClose = document.querySelector('.modal-close');

        // Open Modal
        const galleryCards = document.querySelectorAll('.gallery-card'); // Re-select after dynamic rendering
        galleryCards.forEach(card => {
            card.addEventListener('click', () => {
                const cardId = card.getAttribute('data-id');
                const dataItem = typeof galleryData !== 'undefined' ? galleryData.find(item => item.id == cardId) : null;

                if (dataItem) {
                    // Use data from gallery-data.js
                    modalImg.src = dataItem.image;
                    modalTitle.textContent = dataItem.title;
                    modalCreator.textContent = dataItem.creatorName;
                    modalYear.textContent = dataItem.year;
                    const descElement = document.getElementById('modal-desc');
                    if (descElement) descElement.textContent = dataItem.description || "작품 설명이 없습니다.";

                    // Tags (Optional: if we want to render tags dynamically)
                    // const tagsContainer = document.querySelector('.modal-tags');
                    // if(tagsContainer && dataItem.tags) { ... }

                } else {
                    // Fallback to DOM parsing (for non-dynamic elements if any)
                    const img = card.querySelector('img');
                    const title = card.querySelector('h3');
                    const creator = card.querySelector('.creator-badge');
                    const year = card.getAttribute('data-year');

                    modalImg.src = img.src;
                    modalTitle.textContent = title.textContent;
                    modalCreator.textContent = creator.textContent;
                    modalYear.textContent = year;
                }

                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.add('active');
                }, 10);
            });
        });  // Close Modal Function
        const closeModal = () => {
            modal.classList.add('hidden');
            document.body.style.overflow = '';
        };

        modalClose.addEventListener('click', closeModal);

        // Close on background click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                closeModal();
            }
        });
    }

    // --- Portfolio Page Logic (Formal CV) ---
    const portfolioContent = document.getElementById('portfolio-content');
    if (portfolioContent) {
        // =================================================================
        // [멤버 데이터 수정하는 곳 / EDIT MEMBER DATA HERE]
        // 아래 memberData 객체 안에 있는 내용을 수정하면 포트폴리오 페이지에 반영됩니다.
        // =================================================================
        // 1. Member Data Database (Formal CV Data)
        const memberData = {
            kms: {
                name: "강민수",
                role: "진부중학교 3D 동아리 부장/방송부",
                email: "kms@jinbu.ms.kr",
                summary: "영상제작에 관심이 많으며 3D 동아리 및 방송부 활동으로 실력을 성장해왔습니다.",
                photoColor: "#FF5500", // Placeholder for actual photo
                links: [
                    { name: "ArtStation", url: "#" },
                    { name: "GitHub", url: "#" }
                ],
                education: [
                    { title: "진부중학교 (Jinbu Middle School)", subtitle: "3D 창작 동아리 기장 (Founder)", date: "2023.03 - Present" },
                    { title: "Blender Master Class", subtitle: "Advanced Modeling & Nodes 수료", date: "2024.01 - 2024.03" }
                ],
                awards: [
                    { title: "2024 청소년 3D 모델링 대회", subtitle: "대상 (Grand Prize) - 'City of Tomorrow'", date: "2024.08" },
                    { title: "강원도 창의과학 경진대회", subtitle: "금상 - 가상 시뮬레이션 부문", date: "2023.11" }
                ],
                skills: [
                    { name: "Blender", level: 95 },
                    { name: "Hard Surface Modeling", level: 90 },
                    { name: "Geometry Nodes", level: 75 },
                    { name: "Substance Painter", level: 60 }
                ],
                projects: [
                    {
                        title: "Procedural Sci-Fi City Generator",
                        role: "Solo Developer",
                        desc: "Blender Geometry Nodes를 활용하여 매개변수 조절만으로 다양한 형태의 SF 도시를 생성하는 절차적 시스템 개발. 건물 높이, 밀도, 도로망 등을 실시간으로 수정 가능하도록 최적화함.",
                        tags: ["Blender", "Geometry Nodes", "Python Scripting"]
                    },
                    {
                        title: "School Virtual Tour Project",
                        role: "Project Manager & Environment Artist",
                        desc: "학교 전체를 3D로 구현하여 웹에서 탐방 가능한 가상 투어 제작. 최적화 작업을 주도하여 모바일 환경에서도 60fps 유지 달성. 팀원 4명의 작업 분배 및 일정 관리 담당.",
                        tags: ["Unreal Engine 5", "Optimization", "Team Leading"]
                    }
                ]
            },
            loy: {
                name: "Lee Onyu",
                role: "Character Artist",
                email: "loy@jinbu.ms.kr",
                summary: "스토리텔링이 담긴 캐릭터를 창조하는 캐릭터 아티스트입니다. 인체 해부학에 대한 깊은 이해를 바탕으로 사실적인 조형과 카툰 렌더링 스타일을 모두 소화합니다. 캐릭터의 성격과 서사를 시각적으로 풀어내는 데 강점이 있습니다.",
                photoColor: "#4facfe",
                links: [
                    { name: "ArtStation", url: "#" },
                    { name: "Twitter", url: "#" }
                ],
                education: [
                    { title: "진부중학교 (Jinbu Middle School)", subtitle: "3D 동아리 캐릭터 팀장", date: "2023.03 - Present" },
                    { title: "Anatomy for Artists", subtitle: "인체 드로잉 및 조형 과정 수료", date: "2023.06 - 2023.09" }
                ],
                awards: [
                    { title: "2024 캐릭터 컨셉 아트 공모전", subtitle: "최우수상 - 'Guardian of Digital'", date: "2024.05" },
                    { title: "교내 예술제 전시 부문", subtitle: "인기상", date: "2023.12" }
                ],
                skills: [
                    { name: "ZBrush", level: 90 },
                    { name: "Character Design", level: 95 },
                    { name: "Marvelous Designer", level: 70 },
                    { name: "Anatomy", level: 85 }
                ],
                projects: [
                    {
                        title: "Virtual Idol 'Sera'",
                        role: "Lead Character Artist",
                        desc: "가상 아이돌 'Sera'의 초기 컨셉 디자인부터 3D 모델링, 리깅, 쉐이딩까지 전 과정 담당. 특히 표정 블렌드 쉐이프(Blend Shapes) 52종을 제작하여 풍부한 감정 표현 구현.",
                        tags: ["Character Modeling", "Blend Shapes", "Facial Rigging"]
                    },
                    {
                        title: "Short Animation 'The Spark'",
                        role: "Art Director",
                        desc: "단편 애니메이션의 아트 디렉팅을 맡아 전반적인 톤앤매너 설정 및 캐릭터 스타일 가이드라인 제작. 3명의 팀원들과 협업하여 일관된 비주얼 퀄리티 유지.",
                        tags: ["Art Direction", "Visual Dev", "Collaboration"]
                    }
                ]
            },
            csh: {
                name: "Choi Seungho",
                role: "Environment Artist",
                email: "csh@jinbu.ms.kr",
                summary: "공간에 감정을 불어넣는 배경 아티스트입니다. 빛과 대기를 활용한 무드 연출(Lighting & Atmosphere)에 탁월하며, 대규모 지형 제작 및 자연물 묘사에 강점이 있습니다. 언리얼 엔진을 활용한 리얼타임 렌더링 환경 구축을 즐깁니다.",
                photoColor: "#43e97b",
                links: [
                    { name: "Behance", url: "#" }
                ],
                education: [
                    { title: "진부중학교 (Jinbu Middle School)", subtitle: "3D 동아리 배경/레벨디자인 팀장", date: "2023.03 - Present" }
                ],
                awards: [
                    { title: "2024 환경 디자인 공모전", subtitle: "입선", date: "2024.10" }
                ],
                skills: [
                    { name: "Unreal Engine", level: 80 },
                    { name: "Environment Art", level: 90 },
                    { name: "Lighting", level: 92 },
                    { name: "SpeedTree", level: 60 }
                ],
                projects: [
                    {
                        title: "Project: Ancient Ruins",
                        role: "Solo Project",
                        desc: "잊혀진 고대 유적을 주제로 한 시네마틱 환경 제작. Quixel Megascans 에셋을 활용하되, 커스텀 쉐이더를 통해 독창적인 분위기 연출. Volumetric Fog를 활용한 깊이감 있는 라이팅 세팅 연구.",
                        tags: ["Unreal Engine 5", "Lighting", "Cinematic"]
                    },
                    {
                        title: "Modular Dungeon Kit",
                        role: "Asset Creator",
                        desc: "게임 제작에 사용할 수 있는 모듈형 던전 에셋 키트 제작. 그리드 스냅을 고려한 설계로 레벨 디자인의 효율성을 높임. 텍스처 아틀라스 최적화 적용.",
                        tags: ["Game Assets", "Modular Design", "Optimization"]
                    }
                ]
            }
        };

        // 2. URL Parameter Parsing
        const urlParams = new URLSearchParams(window.location.search);
        const memberId = urlParams.get('member');

        // 3. Render Content
        if (memberId && memberData[memberId]) {
            const data = memberData[memberId];
            const template = document.getElementById('portfolio-template');

            // Clear loading/empty state
            portfolioContent.innerHTML = '';

            // Clone template
            const clone = document.importNode(template.content, true);

            // --- Fill Header ---
            clone.getElementById('cv-name').innerText = data.name;
            clone.getElementById('cv-role').innerText = data.role;
            clone.getElementById('cv-contact').innerText = data.email;

            // Photo Logic (Color or Image)
            const photoDiv = clone.getElementById('cv-photo');
            if (data.photoColor.includes('.') || data.photoColor.includes('http')) {
                // If value looks like a file path or URL
                photoDiv.style.backgroundImage = `url('${data.photoColor}')`;
                photoDiv.style.backgroundColor = 'transparent';
            } else {
                // Determine if it is a color HEX/RGB
                photoDiv.style.backgroundColor = data.photoColor;
            }

            // Links
            const linkContainer = clone.getElementById('cv-links');
            data.links.forEach(link => {
                const a = document.createElement('a');
                a.href = link.url;
                a.className = 'cv-link-badge';
                a.innerText = link.name;
                linkContainer.appendChild(a);
            });

            // --- Fill Sections ---

            // Summary
            clone.getElementById('cv-summary').innerText = data.summary;

            // Education
            const eduContainer = clone.getElementById('cv-education');
            data.education.forEach(edu => {
                const li = document.createElement('li');
                li.className = 'cv-list-item';
                li.innerHTML = `
                    <div class="cv-item-left">
                        <div class="cv-item-title">${edu.title}</div>
                        <div class="cv-item-subtitle">${edu.subtitle}</div>
                    </div>
                    <div class="cv-item-right">${edu.date}</div>
                `;
                eduContainer.appendChild(li);
            });

            // Awards
            const awardContainer = clone.getElementById('cv-awards');
            data.awards.forEach(award => {
                const li = document.createElement('li');
                li.className = 'cv-list-item';
                li.innerHTML = `
                    <div class="cv-item-left">
                        <div class="cv-item-title">${award.title}</div>
                        <div class="cv-item-subtitle">${award.subtitle}</div>
                    </div>
                    <div class="cv-item-right">${award.date}</div>
                `;
                awardContainer.appendChild(li);
            });

            // Skills
            const skillContainer = clone.getElementById('cv-skills');
            data.skills.forEach(skill => {
                const div = document.createElement('div');
                div.className = 'cv-skill-item';
                div.innerHTML = `
                    <span class="cv-skill-name">${skill.name}</span>
                    <div class="cv-skill-bar-container">
                        <div class="cv-skill-bar" style="width: ${skill.level}%"></div>
                    </div>
                `;
                skillContainer.appendChild(div);
            });

            // Projects (Case Studies)
            const projectContainer = clone.getElementById('cv-projects');
            data.projects.forEach(proj => {
                const div = document.createElement('div');
                div.className = 'cv-project-item';

                // Create tags HTML
                const tagsHtml = proj.tags.map(tag => `<span class="cv-tag">${tag}</span>`).join('');

                div.innerHTML = `
                    <div class="cv-project-header">
                        <span class="cv-project-title">${proj.title}</span>
                        <span class="cv-project-role">${proj.role}</span>
                    </div>
                    <p class="cv-project-desc">${proj.desc}</p>
                    <div class="cv-project-tags">
                        ${tagsHtml}
                    </div>
                `;
                projectContainer.appendChild(div);
            });

            // Append to DOM
            portfolioContent.appendChild(clone);

        } else {
            // No valid ID -> Show default empty state (selector)
        }
    }
});
